% The tikz-er2 package.
% Ver. 1.0
% (c) PÃ¡vel Caldo
% January 2009

\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{tikz-er2}[2009/01/31 Entity-relationship diagrams using the
Tikz library]

\RequirePackage{tikz}
\RequirePackage[normalem]{ulem} % for the dashed underline

\usetikzlibrary{shapes.geometric}
\usetikzlibrary{arrows}
\usetikzlibrary{fit}
\usetikzlibrary{snakes}
\usetikzlibrary{shapes,arrows}

\tikzstyle{every entity} = []
\tikzstyle{every entity2} = []
\tikzstyle{every weak entity} = []
\tikzstyle{every attribute} = []
\tikzstyle{every attribute2} = []
\tikzstyle{every relationship} = []
\tikzstyle{every link} = []
\tikzstyle{every isa} = []
\tikzstyle{every document1} = []
\tikzstyle{every document2} = []
\tikzstyle{every document3} = []
\tikzstyle{every document4} = []
\tikzstyle{every poly} = []


\tikzstyle{link} = [>=triangle 60, draw, thick, every link]

\tikzstyle{total} = [>=triangle 60, draw, thick, double, double distance=3pt, every total]

\tikzstyle{entity} = [rectangle, draw, black, very thick,
                      minimum width=6em, minimum height=3em,
                      every entity]

\tikzstyle{entity2} = [rectangle, draw, black, very thick,
                      minimum width=12em, minimum height=7em,
                      every entity2]


\tikzstyle{document1} = [chamfered rectangle, draw, black, very thick,
                      minimum width=6em, minimum height=3em,
                      every document1, chamfered rectangle corners=north east]

\tikzstyle{document2} = [chamfered rectangle, draw, black, very thick,
                      minimum width=6em, minimum height=3em,
                      every document2, chamfered rectangle corners=north east]

\tikzstyle{document3} = [chamfered rectangle, draw, black, very thick,
                      minimum width=6em, minimum height=3em,
                      every document3, chamfered rectangle corners=north east]

\tikzstyle{document4} = [chamfered rectangle, draw, black, dashed, very thick,
                      minimum width=6em, minimum height=3em,
                      every document4, chamfered rectangle corners=north east]


\tikzstyle{weak entity} = [rectangle, draw, black, very thick,
                           minimum width=12em, minimum height=20em, double, double distance=2pt,
                           every weak entity]

\tikzstyle{attribute} = [ellipse, draw, black, very thick,
                         minimum width=5em, minimum height=2em,
                         every attribute]

\tikzstyle{attribute2} = [ellipse, draw, black, very thick,
                         minimum width=5em, minimum height=2em,
                         every attribute2]

%\tikzstyle{key attribute} = [attribute, font=\bfseries]

\tikzstyle{multi attribute} = [attribute, double, double distance=2pt]

\tikzstyle{derived attribute} = [attribute, dashed]

%\tikzstyle{discriminator} = [attribute, font=\itshape]

\tikzstyle{relationship} = [diamond, draw, black, very thick,
                            minimum width=2em, aspect=1,
                            every relationship]

\tikzstyle{ident relationship} = [relationship, double, double distance=2pt]

\tikzstyle{isa} = [isosceles triangle, isosceles triangle apex angle=60,
                   shape border rotate=-90,
                   draw, black, very thick, minimum size=3em,
                   every isa]

\tikzstyle{poly} = [regular polygon,regular polygon sides=5, every poly]


% for text un key attributes
\newcommand{\key}[1]{\underline{#1}}

% for text in discriminator attributes
\def\discriminator{\bgroup
  \ifdim\ULdepth=\maxdimen % Set depth based on font, if not set already
   \settodepth\ULdepth{(j}\advance\ULdepth.4pt\fi
  \markoverwith{\kern.15em
  \vtop{\kern\ULdepth \hrule width .3em}%
  \kern.15em}\ULon}
